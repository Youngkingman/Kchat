(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cc2a612"],{"0946":function(t,e,i){"use strict";i("f5c8")},"096e":function(t,e,i){},"111c":function(t,e,i){},"14c5":function(t,e,i){"use strict";i("d26e")},1677:function(t,e,i){},"17d8":function(t,e,i){"use strict";i("111c")},"49c7":function(t,e,i){},"50cb":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chatroom-container"},[i("el-row",{staticClass:"chatroom-layout",attrs:{gutter:5}},[i("el-col",{attrs:{span:18}},[i("div",{staticClass:"chatroom-chatarea"},[i("KChat",{staticStyle:{height:"100%"},attrs:{taleList:t.list,toolConfig:t.tool,quickList:t.quickList,scrollType:"scroll",width:"100%",height:"120%"},on:{enter:t.bindEnter,clickTalk:t.talkEvent},model:{value:t.inputMsg,callback:function(e){t.inputMsg=e},expression:"inputMsg"}},[i("template",{slot:"tools"},[i("div",{staticStyle:{width:"20rem","text-align":"right"},on:{click:function(e){return t.toolEvent("自定义")}}},[i("b",{attrs:{slot:"tools"},slot:"tools"})])])],2)],1)]),i("el-col",{attrs:{span:6}},[i("div",{staticClass:"chatroom-sideinfo"},[i("RightList",{attrs:{config:t.rightConfig},on:{click:t.rightClick}})],1)])],1)],1)},s=[],n=i("5530"),c=(i("b0c0"),i("e9c4"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"chatPage",style:t.setStyle},[i("div",{staticClass:"taleBox"},[i("chatList",{ref:"chatList",attrs:{list:t.taleList,config:t.chatListConfig},on:{click:function(e){return t.$emit("clickTalk",e)},loadHistory:t.loadHistoryHandler}})],1),i("div",{staticClass:"toolBox"},[i("tools",{staticClass:"tools",attrs:{tools:t.toolConfig},on:{emoji:t.bindEmoji}},[t._t("tools",null,{slot:"tools"})],2),i("quickList",{staticClass:"quickList",attrs:{list:t.quickList,msg:t.msg},on:{submit:t.quickSubmit}}),i("EnterBox",{attrs:{insert:t.insert},on:{submit:function(e){return t.$emit("enter",e)}},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}})],1)])}),r=[],a=(i("ac1f"),i("466d"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"web__msg",on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSend(e)}}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.currentMsg,expression:"currentMsg"}],ref:"msgBox",staticClass:"web__msg-input",attrs:{rows:"3",placeholder:t.placeholder},domProps:{value:t.currentMsg},on:{input:function(e){e.target.composing||(t.currentMsg=e.target.value)}}}),t._v(" "),i("div",{staticClass:"web__msg-menu"},[i("el-button",{staticClass:"web__msg-submit",attrs:{type:"primary",size:"medium"},on:{click:t.handleSend}},[t._v("发送")])],1)])}),l=[],m=(i("498a"),{name:"JwChat_enterbox",props:{placeholder:{type:String,default:"Say something..."},value:{type:String,default:""},insert:{type:String,default:""}},data:function(){return{currentMsg:""}},watch:{value:{handler:function(){this.currentMsg=this.value},immediate:!0},currentMsg:{handler:function(t){var e=t.trim();this.$emit("input",e)},immediate:!0},insert:function(t){t&&this.joinToMsg(t)}},methods:{handleSend:function(t){var e=this,i=t.shiftKey;i||(this.$emit("submit",this.currentMsg),this.$nextTick((function(){e.currentMsg=""})))},joinToMsg:function(t){var e=this.$refs.msgBox,i=this.currentMsg;if(document.selection){var o=null;e.focus(),o=document.selection.createRange(),o.text=t,o.select()}else if(e.selectionStart||"0"==e.selectionStart){var s=e.selectionStart,n=e.selectionEnd,c=e.scrollTop;i=i.substring(0,s)+t+i.substring(n,i.length),c>0&&(e.scrollTop=c),e.focus(),e.selectionStart=s+t.length,e.selectionEnd=s+t.length}else i+=t,e.focus();this.currentMsg=i}}}),h=m,p=(i("e479"),i("2877")),u=Object(p["a"])(h,a,l,!1,null,"2c008c12",null),d=u.exports,f=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper",style:t.boxSize},[i("div",{ref:"scroller",staticClass:"scroller"},[i("div",{ref:"main",staticClass:"web__main"},[i("div",{staticClass:"pulldown-wrapper"},[i("div",{domProps:{innerHTML:t._s(t.historyConfig.tip)}})]),t._l(t.list,(function(e,o){return["tip"===e.type?i("el-divider",{key:JSON.stringify(e)+o},[t._v(t._s(e.text))]):i("div",{key:JSON.stringify(e)+o,staticClass:"web__main-item",class:{"web__main-item--mine":e.mine}},[i("div",{staticClass:"web__main-user"},[i("img",{attrs:{src:e.img},on:{click:function(i){return t.$emit("click",{type:"img",data:e})}}}),i("cite",{on:{click:function(i){return t.$emit("click",{type:"nickname",data:e})}}},[t._v(" "+t._s(e.name)+" "),i("i",[t._v(t._s(e.date))])])]),i("div",{staticClass:"web__main-text"},[i("div",{staticClass:"web__main-arrow"}),e.text.text?i("itemTalk",{attrs:{text:e.text.text},on:{systemEvent:t.taskEvent,loadDone:t.loadDone}}):t._e(),e.text.system?i("systemTalk",{attrs:{text:e.text.system},on:{systemEvent:t.systemEvent,loadDone:t.loadDone}}):t._e(),e.text.subLink?i("el-link",t._b({staticClass:"itemChild",on:{click:function(i){return t.taskEvent(e.text)}}},"el-link",e.text.subLink.prop,!1),[t._v(" "+t._s(e.text.subLink.text)+" ")]):t._e(),e.text.shop?i("shopTalk",{attrs:{text:e.text.shop},on:{systemEvent:t.taskEvent,loadDone:t.loadDone}}):t._e()],1)])]}))],2)]),t.showDownBtn?i("div",{staticClass:"downBtn",on:{click:t.scrollBottom}},[t.unread?i("span",[t._v(t._s(t.unread))]):t._e()]):t._e()])},g=[],v=i("4f96"),x=(i("fb6a"),i("d4ec")),w=i("bee2"),q=i("ade3"),b=(i("c740"),i("d3b7"),i("159b"),i("229e")),k=i("0d3b"),y=i("8d9f"),_=i("2cd8"),C=i("a94d"),S=i("5228");b["a"].use(k["a"]),b["a"].use(y["a"]),b["a"].use(_["a"]),b["a"].use(C["a"]),b["a"].use(S["a"]);var T={moving:{enter:"enter",leave:"leave"},fetching:"fetching",succeed:"succeed"},j=function(){function t(e){var i=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(x["a"])(this,t),Object(q["a"])(this,"domPotision",[]),Object(q["a"])(this,"beforeNode",null),Object(q["a"])(this,"viewName",null),Object(q["a"])(this,"tipText",""),Object(q["a"])(this,"scrollType",""),Object(q["a"])(this,"isLoding",!1),Object(q["a"])(this,"saveNodes",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.nodes,o=void 0===e?[]:e,s=t.dataList,n=[],c=i.domPotision;for(var r in o)Object.hasOwnProperty.call(o,r)&&function(){var t=o[r],e=JSON.stringify(s[r]),i=t.offsetTop,a={top:i,node:t,read:!1,data:e},l=c.findIndex((function(t){return t.data===e}));if("number"===typeof l&&l>-1){var m=c[l]||{},h=m.read,p=void 0!==h&&h;a.read=p}n.push(a)}();i.domPotision=n,i.readState()}));var s=o.scrollType,n=o.pullingDown,c=void 0===n?{threshold:70,stop:56,mouseWheel:!0}:n;s&&(this.scrollType=s),this.viewName=e;var r=new b["a"](e,{scrollY:!0,click:!0,probeType:3,observeDOM:!0,mouseWheel:!0,observeImage:!0,scrollbar:{fade:!1,interactive:!0,scrollbarTrackClickable:!0},pullDownRefresh:c,preventDefault:!1});r.on("scrollEnd",(function(){i.setLoding(!1),i.savePosition()})),c&&(r.on("enterThreshold",(function(){i.setLoding(!0),i.setTipText(T.moving.enter)})),r.on("leaveThreshold",(function(){i.setTipText(T.moving.leave)}))),this.Scroll=r}return Object(w["a"])(t,[{key:"refresh",value:function(){this.Scroll.refresh()}},{key:"setTipText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T.default,e='<svg width="16" height="16" viewBox="0 0 512 512"><path fill="currentColor" d="M367.997 338.75l-95.998 95.997V17.503h-32v417.242l-95.996-95.995l-22.627 22.627L256 496l134.624-134.623l-22.627-22.627z"></path></svg>',i='<svg width="16" height="16" viewBox="0 0 512 512"><path fill="currentColor" d="M390.624 150.625L256 16L121.376 150.625l22.628 22.627l95.997-95.998v417.982h32V77.257l95.995 95.995l22.628-22.627z"></path></svg>',o={enter:"".concat(e," 下拉"),leave:"".concat(i," 刷新"),fetching:"加载中...",succeed:"刷新完成"};this.tipText=o[t]}},{key:"finishPullDown",value:function(){this.setTipText(T.succeed),this.Scroll.finishPullDown()}},{key:"setLoding",value:function(t){this.isLoding=t}},{key:"pullingDownHandler",value:function(){this.savePosition(0),this.setTipText(T.fetching)}},{key:"on",value:function(t,e){var i=this;this.Scroll.on(t,(function(){"pullingDown"===t&&i.pullingDownHandler(),e()}))}},{key:"unread",get:function(){var t=0;return this.domPotision.forEach((function(e){var i=e.read;i||(t+=1)})),t}},{key:"readState",value:function(){var t=this,e=this.Scroll.y,i=Math.abs(e),o=this.viewName.clientHeight||0,s=-1;this.beforeNode&&(s=this.domPotision.findIndex((function(e){return e.data===t.beforeNode.data}))),this.domPotision.forEach((function(t,e){var n=t.top,c=t.node,r=c.clientHeight;(i+o>n+.9*r||s>e)&&(t.read=!0)}))}},{key:"isBottom",get:function(){var t=!1,e=this.Scroll,i=e.y,o=e.maxScrollY;return t=Math.abs(i)>=Math.abs(o),t}},{key:"scrollBottom",value:function(){this.Scroll.scrollTo(0,this.Scroll.maxScrollY,200)}},{key:"scrollPositionDom",value:function(){var t=this.Scroll.y;if(t>=0)return 0;var e=Math.abs(t),i=this.domPotision,o=-1;return i.forEach((function(t,i){var s=t.top;-1===o&&(o=i),e>=s&&(o=i+1)})),o}},{key:"savePosition",value:function(){var t=this.scrollPositionDom();this.beforeNode=this.domPotision[t]}}]),t}(),O=j,L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("span",{staticClass:"item_msg",on:{click:t.itemCallback}},["span"===t.getTag?i("span",{domProps:{innerHTML:t._s(t.parseText())}}):t._e(),"img"===t.getTag?i("img",{staticClass:"web__msg--img",attrs:{src:t.getData.src,alt:""},on:{click:function(e){return t.showDialog({tag:"img"})},load:function(e){return t.load("img")}}}):t._e(),"video"===t.getTag?i("video",{staticClass:"web__msg--video",attrs:{src:t.getData.src,controls:"controls"},on:{click:function(e){return t.showDialog({tag:"video"})},canplaythrough:function(e){return t.load("video")}}}):t._e(),"audio"===t.getTag?i("audio",{staticClass:"web__msg--audio",staticStyle:{width:"20rem",height:"20px"},attrs:{src:t.getData.src,controls:"controls"},on:{canplaythrough:function(e){return t.load("audio")}}}):t._e(),["video","img"].includes(t.getTag)?i("el-dialog",{staticClass:"web__dialog",attrs:{visible:t.show,width:"40%","append-to-body":"","before-close":t.handleClose},on:{"update:visible":function(e){t.show=e}}},[t.imgSrc?i("img",{staticStyle:{width:"100%","object-fit":"cover"},attrs:{src:t.imgSrc}}):t._e(),t.videoSrc?i("video",{staticStyle:{width:"100%","object-fit":"cover"},attrs:{src:t.videoSrc,controls:"controls"}}):t._e(),t.audioSrc?i("audio",{staticStyle:{width:"100%","object-fit":"cover"},attrs:{src:t.audioSrc,controls:"controls"}}):t._e()]):t._e()],1)},E=[],$=(i("5319"),i("1276"),i("caad"),i("2532"),i("c1b7")),D=i("865f");console.log(D);var H={props:{text:String},data:function(){return{tags:["img","video","audio"],show:!1,imgSrc:"",videoSrc:"",audioSrc:"",loadState:!1}},computed:{getTag:function(){var t=this.text||"",e="span",i="";return t.match(/<\/?[^>]+>/)&&(i=t.split(" ")[0].replace(/<|>/,"")||"",this.tags.includes(i)&&(e=i)),e},getData:function(){var t=this.text||"",e=document.createElement("div");e.innerHTML=t;var i=e.firstChild,o=i.getAttribute("data-src"),s=i.getAttribute("controls")||!1;return{src:o,controls:s}}},methods:{load:function(t){this.loadState||(this.loadState=!0,this.$emit("loadDone",{type:t,target:this.text}))},handleClose:function(t){this.imgSrc=void 0,this.videoSrc=void 0,this.audioSrc=void 0,t()},showDialog:function(t){var e=this,i=t.tag,o=this.getData.src,s=function(){"img"===i?(e.imgSrc=o,e.show=!0):"video"===i?(e.videoSrc=o,e.show=!0):"audio"===i?(e.audioSrc=o,e.show=!0):"FILE"===i&&window.open(o)};"function"===typeof this.beforeOpen?this.beforeOpen({tag:i,src:o},s):s()},itemCallback:function(){this.$emit("systemEvent",this.text)},parseText:function(){var t=this.text;if(t){t=t.replace(/\n/g,"<br/>");var e=Object($["a"])(t).replace(/<img src/g,'<img data-class="iconBox" src');return e=e.replace("https://res.wx.qq.com/wxdoc/dist/assets/img/emoji-sprite.b5bd1fe0.png",D),e}}},mounted:function(){var t=this,e=this.getTag;this.tags.includes(e)||this.$nextTick((function(){t.$emit("loadDone",{type:e,target:t.text})}))}},M=H,B=(i("17d8"),Object(p["a"])(M,L,E,!1,null,"4639c160",null)),A=B.exports,P=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"systemTalk"},[i("div",{staticClass:"title"},[t._v(t._s(t.text.title))]),i("div",{staticClass:"subtitle"},[t._v(t._s(t.text.subtitle))]),t._l(t.text.content,(function(e){return i("div",{key:JSON.stringify(e)},[i("el-link",{attrs:{type:"primary"},on:{click:function(i){return i.stopPropagation(),t.itemCallback(e)}}},[t._v(t._s(e.text))])],1)}))],2)},N=[],J={props:{text:{type:Object,default:function(){return{}}}},methods:{itemCallback:function(t){this.$emit("systemEvent",t)}},mounted:function(){var t=this;this.$nextTick((function(){t.$emit("loadDone",{type:"system",target:t.text})}))}},I=J,Y=(i("cf9e"),Object(p["a"])(I,P,N,!1,null,"31e21c0f",null)),z=Y.exports,R=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"shopTalk",on:{click:t.itemCallback}},[i("div",{staticClass:"cover"},[i("img",{attrs:{src:t.text.cover,alt:""}})]),i("div",{staticClass:"price"},[t._v(" "+t._s(t.text.price))]),i("div",{staticClass:"title"},[t._v(t._s(t.text.title))]),t.text.describe?i("div",{staticClass:"subtitle"},[t._v(t._s(t.text.describe))]):t._e(),t.text.tags&&t.text.tags.length?i("div",{staticClass:"tagBox"},t._l(t.text.tags,(function(e,o){return i("span",{key:o},[t._v(" "+t._s(e.name)+" ")])})),0):t._e()])},W=[],F={props:{text:{type:Object,default:function(){return{}}}},methods:{itemCallback:function(){this.$emit("systemEvent",Object(n["a"])(Object(n["a"])({},this.text),{},{type:"shop"}))}},mounted:function(){var t=this;this.$nextTick((function(){t.$emit("loadDone",{type:"shop",target:t.text})}))}},U=F,K=(i("e2af"),Object(p["a"])(U,R,W,!1,null,"95793ca4",null)),G=K.exports,V={name:"JwChat_list",components:{itemTalk:A,systemTalk:z,shopTalk:G},props:{list:{type:Array,default:function(){return[]}},config:{type:Object,default:function(){return{}}}},data:function(){return{scroll:null,stopScroll:!1}},computed:{boxSize:function(){var t=this.config||{},e=t.height,i=void 0===e?"382px":e,o=t.width,s=void 0===o?"525px":o;return"".concat(i).match(/\d$/)&&(i+="px"),"".concat(s).match(/\d$/)&&(s+="px"),{height:i,width:s}},historyConfig:function(){var t=this.config.historyConfig||{},e=t.tip,i=void 0===e?"":e,o=t.show,s=void 0!==o&&o,n=this.scroll||{},c=n.tipText;return{tip:i||c,show:s}},scrollType:function(){var t=this.config.scrollType,e=void 0===t?"noroll":t;return e},unread:function(){var t=this.scroll||{},e=t.unread,i=void 0===e?0:e;return i},showDownBtn:function(){return!!this.scroll&&!this.scroll.isBottom}},watch:{boxSize:function(){this.scroll.refresh()}},methods:{loadDone:function(){"scroll"==this.scrollType&&this.scrollBottom()},scrollBottom:function(){this.scroll&&(this.scroll.isLoding||(this.scroll.refresh(),this.scroll.scrollBottom()))},createScroll:function(){var t=this.historyConfig||{},e=t.show,i=void 0!==e&&e;this.scroll=new O(this.$refs.scroller,{scrollType:this.scrollType,pullingDown:i}),this.scroll.on("refresh",this.childnodeLoad),i&&this.scroll.on("pullingDown",this.pullingDownHandler)},finishPullDown:function(){this.scroll.finishPullDown()},childnodeLoad:function(){if("noroll"===this.scrollType){var t=this.$refs.main;if(t){var e=Object(v["a"])(t.children),i=e.slice(1);this.scroll.saveNodes({nodes:i,dataList:this.list})}}},pullingDownHandler:function(){this.$emit("loadHistory")},systemEvent:function(t){this.$emit("click",{type:"systemItem",data:t})},taskEvent:function(t){this.$emit("click",{type:"taskItem",data:t})}},mounted:function(){this.createScroll()}},X=V,Q=(i("5578"),Object(p["a"])(X,f,g,!1,null,"54349690",null)),Z=Q.exports,tt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"toolsBox"},[t.showEmoji?[i("el-popover",{ref:"popover",attrs:{placement:"top-start",trigger:"click"}},[i("ul",{staticClass:"emjioBox"},t._l(Object.keys(t.emoji),(function(e){return i("li",{key:e,on:{click:function(i){return t.selectEmit(e)}}},[t.emoji[e]&&t.emoji[e].position?i("a",{style:t.emojiStyle(e)}):t.emoji[e].length<5?i("a",[t._v(t._s(t.emoji[e]))]):i("img",{attrs:{src:t.emoji[e]}})])})),0),i("JwChat-icon",{staticClass:"toolIcon",attrs:{slot:"reference",type:"icon-xiaolian",title:"表情"},slot:"reference"})],1)]:t._e(),t._l(t.showkeys,(function(e,o){return[t.toolConfig[e]?i("span",{key:e},[i("span",{on:{click:function(i){return t.bindButton(e)}}},[i("JwChat-icon",{staticClass:"toolIcon",attrs:{type:t.toolConfig[e].icon,title:t.iconTitle(e,o)}})],1)]):i("i",{key:e,class:e,on:{click:function(i){return t.bindButton(e)}}})]})),t._t("tools")],2)},et=[],it=(i("b64b"),i("d11e")),ot={name:"JwChat-tools",props:{tools:{type:Object,default:function(){return{show:["file"],showEmoji:!0,callback:function(){}}}}},data:function(){return{emoji:it,toolConfig:{file:{icon:"icon-wenjian",title:"文件"},video:{icon:"icon-shipin",title:"视频"},img:{icon:"icon-xiangce",title:"图片"},hongbao:{icon:"icon-hongbao",title:"红包"},history:{icon:"icon-lishi",title:"历史"},more:{icon:"icon-gengduo",title:"更多"}},newTitle:null}},computed:{showEmoji:function(){var t=this.tools||{},e=t.showEmoji,i=void 0===e||e;return i},showkeys:function(){var t=this,e=Object.keys(this.toolConfig),i=this.tools||{},o=i.show,s=void 0===o?[]:o,n=[];return s.length>0&&s.forEach((function(i){Array.isArray(i)?t.newTitle=i:e.includes(i)&&n.push(i)})),n}},methods:{iconTitle:function(t,e){var i="";return this.newTitle&&(i=this.newTitle[e]||""),i||(i=this.toolConfig[t].title),i},selectEmit:function(t){this.$emit("emoji",t),this.$refs.popover.doClose()},bindButton:function(t){if(!this.tools.callback)return console.warn("callback not find");"file"===t?this.openFile(t,this.tools.callback):this.tools.callback(t)},openFile:function(t,e){var i=document.createElement("input");i.type="file",i.multiple="multiple",i.click(),i.onchange=function(){var o=i.files;e(t,o)}},emojiStyle:function(t){var e=this.emoji[t];return e?{display:"inline-block",background:"url('https://res.wx.qq.com/a/wx_fed/webwx/res/static/img/6AfH8-r.png')  no-repeat",width:"28px",height:"28px","background-position":e.position}:{}}}},st=ot,nt=(i("0946"),Object(p["a"])(st,tt,et,!1,null,"336f15a7",null)),ct=nt.exports,rt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.showList.length?i("div",{ref:"quickListBox",staticClass:"quickListBox"},[i("div",{staticClass:"quickList"},t._l(t.showList,(function(e,o){return i("div",{key:o,staticClass:"quickItem"},[i("span",{domProps:{innerHTML:t._s(e.showtext)}}),i("i",{staticClass:"enterBtn el-icon-circle-check",attrs:{title:"选择"},on:{click:function(i){return t.submit(e)}}})])})),0)]):t._e()},at=[],lt=(i("4d63"),i("2c3e"),i("25f0"),i("00b4"),{components:{},data:function(){return{scroll:null,complete:null}},props:{list:{type:Array,default:function(){return[]}},msg:{type:String,default:""}},computed:{showList:function(){var t=this.msg;if(!t)return[];var e=this.list,i=new RegExp(t),o=[];return e.forEach((function(e){var s=e.text;if(i.test(s)){var c=s.replace(i,"<b>".concat(t,"</b>"));o.push(Object(n["a"])(Object(n["a"])({},e),{},{showtext:c}))}})),o}},methods:{submit:function(t){this.$emit("submit",t)}}}),mt=lt,ht=(i("c9a1"),Object(p["a"])(mt,rt,at,!1,null,"65e410f9",null)),pt=ht.exports,ut={name:"KChat",components:{EnterBox:d,chatList:Z,tools:ct,quickList:pt},props:{taleList:{type:Array,default:function(){return[]}},height:{default:"500px"},width:{default:"550px"},value:{default:""},scrollType:{default:""},toolConfig:{type:Object},config:{},quickList:{type:Array,default:function(){return[]}}},data:function(){return{msg:"",insert:""}},watch:{value:{handler:function(){this.msg=this.value},immediate:!0},msg:{handler:function(){this.$emit("input",this.msg)},immediate:!0}},computed:{setStyle:function(){var t=this.height,e=this.width;"".concat(t).match(/\d$/)&&(t+="px"),"".concat(e).match(/\d$/)&&(e+="px");var i={height:t,width:e};return i},talkHeight:function(){var t=this.height;return"".concat(t).match(/\d$/)?t-=140:t="calc(".concat(t," - 140px)"),t},chatListConfig:function(){var t=this.width,e=this.talkHeight,i=this.scrollType,o=this.config;o=void 0===o?{}:o;var s=o.historyConfig,n=void 0===s?{}:s;return{width:t,height:e,scrollType:i,historyConfig:n}}},methods:{bindEmoji:function(t){var e=this;this.insert=t,this.$nextTick((function(){e.insert=""}))},loadHistoryHandler:function(){var t=this.chatListConfig.historyConfig;t=void 0===t?{}:t;var e=t.callback,i=void 0===e?null:e;i&&i()},quickSubmit:function(t){var e=this,i=t.text;this.msg=i,this.$nextTick((function(){e.$emit("enter",t),e.msg=""}))},finishPullDown:function(){this.$refs.chatList.finishPullDown()}}},dt=ut,ft=(i("dfe0"),Object(p["a"])(dt,c,r,!1,null,"71fcd592",null)),gt=ft.exports,vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper"},[i("div",{staticClass:"notice",staticStyle:{}},[t.info.notice?t._e():i("JwChat-empty",{staticClass:"empty",attrs:{size:"8rem"}}),i("p",{staticClass:"annoucement"},[t._v(t._s(t.info.tip))]),i("p",{staticStyle:{"font-size":"0.8rem","margin-top":"0.5rem",padding:"0 0.2rem"}},[t._v(" "+t._s(t.info.notice)+" ")])],1),i("div",{staticClass:"userList"},[i("div",[t._v(t._s(t.info.listTip)+" ("+t._s(t.dataList.length)+")")]),i("div",[i("el-input",{attrs:{placeholder:t.info.filterTip,clearable:"",size:"mini"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})],1),i("div",{staticClass:"listBox"},[i("div",{ref:"scrollBox",staticClass:"scrollBox"},[i("ul",t._l(t.dataList,(function(e,o){return i("li",{key:o},[i("JwChat-item",{attrs:{size:"45",config:e},on:{click:t.bindClick}})],1)})),0)])])])])},xt=[],wt=(i("4de4"),{name:"RightList",props:{config:Object},data:function(){return{filter:"",scroll:null}},watch:{"config.list":{handler:function(t){t&&this.scrollRefresh()},deep:!0,immediate:!0}},mounted:function(){var t=this.$refs.scrollBox;this.scroll=new O(t,{pullingDown:!1})},computed:{info:function(){var t=this.config,e=t.tip,i=void 0===e?"Group Announcement":e,o=t.notice,s=void 0===o?"":o,n=t.listTip,c=void 0===n?"Group Member":n,r=t.filterTip,a=void 0===r?"Search Users":r;return{tip:i,notice:s,listTip:c,filterTip:a}},dataList:function(){var t=this.config.userlist,e=void 0===t?[]:t,i=this.filter;if(!i)return e;var o=[],s=new RegExp(i,"g");return e.forEach((function(t){var e=t.name;s.test(e)&&o.push(t)})),o}},methods:{bindClick:function(t){this.$emit("click",t)},scrollRefresh:function(){if(this.scroll){var t=this;t.complete=setInterval((function(){"complete"===document.readyState&&(window.clearInterval(t.complete),t.scroll.refresh())}),50)}}}}),qt=wt,bt=(i("14c5"),Object(p["a"])(qt,vt,xt,!1,null,"be203d6a",null)),kt=bt.exports,yt=i("a999"),_t=i("5f87");i("4d90");function Ct(t,e){var i,o={"Y+":e.getFullYear().toString(),"m+":(e.getMonth()+1).toString(),"d+":e.getDate().toString(),"H+":e.getHours().toString(),"M+":e.getMinutes().toString(),"S+":e.getSeconds().toString()};for(var s in o)i=new RegExp("("+s+")").exec(t),i&&(t=t.replace(i[1],1==i[1].length?o[s]:o[s].padStart(i[1].length,"0")));return t}var St=i("2f62"),Tt=i("5c96"),jt=i("b775"),Ot={components:{KChat:gt,RightList:kt},data:function(){return{websocket:null,inputMsg:"",list:[],tool:{show:["file","video","img"],showEmoji:!0,callback:this.toolEvent},quickList:[{text:"stupid list"}],rightConfig:{listTip:"Curruent Online",userlist:[]},chatterlist:[]}},computed:Object(n["a"])({},Object(St["b"])(["name","uid","avatar"])),methods:{fetchUsers:function(){var t=this,e=this.getrid();Object(yt["c"])(e).then((function(e){t.rightConfig.userlist=e}))},getrid:function(){var t=this.$route.name;return"Chatroom1"===t?1:2},bindEnter:function(){var t=this.inputMsg;if(t){var e={room_id:this.getrid(),uid:this.uid,date:Ct("YYYY-mm-dd HH:MM:SS",new Date),text:{text:t},mine:!0,type:0,name:this.name,img:this.avatar};if(null!==this.websocket){var i=JSON.stringify(e);this.websocket.send(i)}this.addMsgToList(e)}},addMsgToList:function(t){this.list.push(t)},initWebsocket:function(){!1 in window&&alert("WebSocket is not supported on you device, Sorry");var t=Object(_t["a"])(),e=jt["a"]+"/chat/ws?token="+t+"&rid="+this.getrid();this.websocket=new WebSocket(e),console.log("init websocket at "+e,this.websocket),this.websocket.onopen=this.websocketonopen,this.websocket.onerror=this.websocketonerror,this.websocket.onmessage=this.websocketonmessage,this.websocket.onclose=this.websocketonclose},websocketonopen:function(){console.log("websocket connect success!")},websocketonerror:function(t){console.log("websocket connect error!",t)},websocketonclose:function(t){console.log("connection closed ("+t.code+")")},websocketonmessage:function(t){var e=JSON.parse(t.data);switch(e.type){case 1:break;case 2:this.fetchUsers();break;case 3:this.fetchUsers();break;case 4:break;case 5:break;default:}this.addMsgToList(e)},keepAlive:function(){this.websocket.readyState==WebSocket.CLOSED&&this.joined&&(console.log("reconnect"),this.initWebsocket())},toolEvent:function(t,e){console.log("tools",t,e)},talkEvent:function(t){console.log(t)},rightClick:function(t){console.log("rigth",t)}},created:function(){var t=this,e=this.getrid();Object(yt["b"])(e).then((function(e){e.canenter?(t.fetchUsers(),t.initWebsocket()):(Object(Tt["Message"])({message:"You can't enter now. Signup for this room first",type:"error",duration:5e3}),t.$router.push("/home"))}))},mounted:function(){setInterval(this.keepAlive,1e4)}},Lt=Ot,Et=(i("d117"),Object(p["a"])(Lt,o,s,!1,null,"00c6206e",null));e["default"]=Et.exports},5578:function(t,e,i){"use strict";i("e14f")},"7f1c":function(t,e,i){},"865f":function(t,e,i){t.exports=i.p+"static/img/emoji-sprite.b5bd1fe0.png"},a999:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return c}));var o=i("b775");function s(t){return Object(o["b"])({url:"/chat/addchatroomuser",method:"put",data:t})}function n(t){return Object(o["b"])({url:"/chat/roomuserlist",method:"get",params:{rid:t}})}function c(t){return Object(o["b"])({url:"/chat/checkroomaccess",method:"get",params:{rid:t}})}},c9a1:function(t,e,i){"use strict";i("49c7")},cf9e:function(t,e,i){"use strict";i("ee97")},d117:function(t,e,i){"use strict";i("096e")},d11e:function(t){t.exports=JSON.parse('{"/::)":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/0.gif","/::~":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/1.gif","/::B":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/2.gif","/::|":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/3.gif","/:8-)":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/4.gif","/::<":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/5.gif","/::$":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/6.gif","/::X":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/7.gif","/::Z":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/8.gif","/::\'(":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/9.gif","/::-|":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/10.gif","/::@":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/11.gif","/::P":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/12.gif","/::D":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/13.gif","/::O":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/14.gif","/::(":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/15.gif","/::+":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/16.gif","/:--b":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/17.gif","/::Q":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/18.gif","/::T":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/19.gif","/:,@P":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/20.gif","/:,@-D":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/21.gif","/::d":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/22.gif","/:,@o":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/23.gif","/::g":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/24.gif","/:|-)":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/25.gif","/::!":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/26.gif","/::L":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/27.gif","/::>":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/28.gif","/::,@":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/29.gif","/:,@f":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/30.gif","/::-S":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/31.gif","/:?":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/32.gif","/:,@x":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/33.gif","/:,@@":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/34.gif","/::8":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/35.gif","/:,@!":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/36.gif","/:!!!":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/37.gif","/:xx":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/38.gif","/:bye":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/39.gif","/:wipe":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/40.gif","/:dig":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/41.gif","/:handclap":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/42.gif","/:&-(":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/43.gif","/:B-)":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/44.gif","/:<@":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/45.gif","/:@>":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/46.gif","/::-O":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/47.gif","/:>-|":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/48.gif","/:P-(":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/49.gif","/::\'|":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/50.gif","/:X-)":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/51.gif","/::*":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/52.gif","/:@x":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/53.gif","/:8*":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/54.gif","/:pd":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/55.gif","/:<W>":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/56.gif","/:beer":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/57.gif","/:basketb":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/58.gif","/:oo":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/59.gif","/:coffee":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/60.gif","/:eat":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/61.gif","/:pig":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/62.gif","/:rose":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/63.gif","/:fade":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/64.gif","/:showlove":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/65.gif","/:heart":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/66.gif","/:break":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/67.gif","/:cake":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/68.gif","/:li":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/69.gif","/:bome":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/70.gif","/:kn":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/71.gif","/:footb":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/72.gif","/:ladybug":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/73.gif","/:shit":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/74.gif","/:moon":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/75.gif","/:sun":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/76.gif","/:gift":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/77.gif","/:hug":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/78.gif","/:strong":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/79.gif","/:weak":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/80.gif","/:share":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/81.gif","/:v":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/82.gif","/:@)":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/83.gif","/:jj":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/84.gif","/:@@":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/85.gif","/:bad":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/86.gif","/:lvu":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/87.gif","/:no":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/88.gif","/:ok":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/89.gif","/:love":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/90.gif","/:<L>":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/91.gif","/:jump":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/92.gif","/:shake":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/93.gif","/:<O>":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/94.gif","/:circle":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/95.gif","/:kotow":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/96.gif","/:turn":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/97.gif","/:skip":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/98.gif","/:oY":"https://res.wx.qq.com/mpres/htmledition/images/icon/emotion/99.gif",":smile:":{"panel":"6AfH8","position":"2px 2px"},":mask:":{"panel":"6AfH8","position":"-30px 2px"},":joy:":{"panel":"6AfH8","position":"-62px 2px"},":stuck_out_tongue_closed_eyes:":{"panel":"6AfH8","position":"-94px 2px"},":flushed:":{"panel":"6AfH8","position":"-126px 2px"},":scream:":{"panel":"6AfH8","position":"-158px 2px"},":pensive:":{"panel":"6AfH8","position":"-190px 2px"},":unamused:":{"panel":"6AfH8","position":"-222px 2px"},"[Hey]":{"panel":"6AfH8","position":"-254px 2px"},"[Facepalm]":{"panel":"6AfH8","position":"-286px 2px"},"[Smirk]":{"panel":"6AfH8","position":"-318px 2px"},"[Smart]":{"panel":"6AfH8","position":"-350px 2px"},"[Concerned]":{"panel":"6AfH8","position":"-382px 2px"},"[Yeah!]":{"panel":"6AfH8","position":"-414px 2px"},":ghost:":{"panel":"6AfH8","position":"-446px 2px"},":pray:":{"panel":"6AfH8","position":"2px -30px"},":muscle:":{"panel":"6AfH8","position":"-30px -30px"},":tada:":{"panel":"6AfH8","position":"-62px -30px"},":gift:":{"panel":"6AfH8","position":"-94px -30px"},"[Packet]":{"panel":"6AfH8","position":"-126px -30px"},"[好的]":"👌","[加油]":"💪️"}')},d26e:function(t,e,i){},d399:function(t,e,i){},dfe0:function(t,e,i){"use strict";i("7f1c")},e14f:function(t,e,i){},e2af:function(t,e,i){"use strict";i("d399")},e479:function(t,e,i){"use strict";i("1677")},ee97:function(t,e,i){},f5c8:function(t,e,i){}}]);